
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Chapter 9 Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="10-Clustering_marker_points.html" />
    
    
    <link rel="prev" href="08-Creating_controls.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="01-Introduction.html">
            
                <a href="01-Introduction.html">
            
                    
                    Chapter 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="02-First_Leaflet_Map.html">
            
                <a href="02-First_Leaflet_Map.html">
            
                    
                    Chapter 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="03-Add_ons.html">
            
                <a href="03-Add_ons.html">
            
                    
                    Chapter 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="04-Embedding_Leaflet_Map_to_an_External_Website.html">
            
                <a href="04-Embedding_Leaflet_Map_to_an_External_Website.html">
            
                    
                    Chapter 4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="05-Using_geojson_files_in_Leaflet.html">
            
                <a href="05-Using_geojson_files_in_Leaflet.html">
            
                    
                    Chapter 5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="06-Custom_markers.html">
            
                <a href="06-Custom_markers.html">
            
                    
                    Chapter 6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="07-Creating_an_interactive_choropleth_map.html">
            
                <a href="07-Creating_an_interactive_choropleth_map.html">
            
                    
                    Chapter 7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="08-Creating_controls.html">
            
                <a href="08-Creating_controls.html">
            
                    
                    Chapter 8
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.10" data-path="09-Heatmaps.html">
            
                <a href="09-Heatmaps.html">
            
                    
                    Chapter 9
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="10-Clustering_marker_points.html">
            
                <a href="10-Clustering_marker_points.html">
            
                    
                    Chapter 10
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="11-Mobile_friendly_web_apps.html">
            
                <a href="11-Mobile_friendly_web_apps.html">
            
                    
                    Chapter 11
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="12-Web_Map_Services.html">
            
                <a href="12-Web_Map_Services.html">
            
                    
                    Chapter 12
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="13-Standard_website_with_leaflet_project.html">
            
                <a href="13-Standard_website_with_leaflet_project.html">
            
                    
                    Chapter 13
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="14-ESRI_Leaflet.html">
            
                <a href="14-ESRI_Leaflet.html">
            
                    
                    Chapter 14
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Chapter 9</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="heatmaps">Heatmaps</h1>
<h2 id="what-are-heatmaps">What are heatmaps?</h2>
<p><a href="https://www.gislounge.com/heat-maps-in-gis/" target="_blank">Heatmaps</a> are a type of maps that geographically visualize locations with patterns of higher than average occurrence of particular variables say crime, disease, service centres and et cetera. </p>
<h2 id="loading-the-heatmap-plugin">Loading the heatmap plugin</h2>
<p>Leaflet does not have a prepackaged tool for drawing heatmaps. Instead, we have to use an external plugin by the name of <a href="https://github.com/Leaflet/Leaflet.heat" target="_blank">Leaflet.heat</a>. The link to the zipfile is available <a href="https://codeload.github.com/Leaflet/Leaflet.heat/zip/refs/heads/gh-pages" target="_blank">here</a>. Download and extract the folder to the same directory as your <code>map.html</code>.</p>
<p>Once you have extracted the zip file contents, open your <code>map.html</code> and add the following <code>&lt;script&gt;</code> tag within your <code>&lt;head&gt;</code> element. </p>
<pre><code>&lt;script src=&quot;Leaflet.heat-gh-pages\Leaflet.heat-gh-pages\dist\leaflet-heat.js&quot;&gt;&lt;/script&gt;
</code></pre><p>Thereafter, we will have to think of a way of loading the GeoJson to a new JavaScript file called <code>heatmap.js</code>. This is where we shall write our heatmap code. You may think of using <code>fetch</code> or <code>L.geoJson.ajax</code> for this purpose but not so fast! The aforementioned methods failed in creating a heatmap. According to the documentation, heatmaps are created using <code>L.heatLayer</code>. Parsing <code>fetch</code> or <code>L.geoJson.ajax</code> into <code>L.heatLayer</code> to supposedly create a heatmap out of our GeoJSON points was not working. This is despite the two GeoJSON methods working well for various purposes in previous chapters. Thus, a new approach was needed.</p>
<p>After much internet searching, a code in Stack Overflow came to the rescue. However, it only works after inserting another Ajax plugin. Luckily no download is needed so insert this new <code>&lt;script&gt;</code> into your <code>map.html</code>.</p>
<pre><code>&lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js&quot;&gt;&lt;/script&gt;
</code></pre><h2 id="creating-the-leaflet-heatmap">Creating the Leaflet heatmap</h2>
<p>Let&apos;s call the usual suspects of adding a basemap.</p>
<pre><code>var map = L.map(&apos;myMap&apos;).setView([0.3556, 37.5833], 6.5);

L.tileLayer(&apos;https://tile.openstreetmap.org/{z}/{x}/{y}.png&apos;, {
    attribution: &apos;&amp;copy; &lt;a href=&quot;https://www.openstreetmap.org/copyright&quot;&gt;OpenStreetMap&lt;/a&gt; contributors&apos;
}).addTo(map);
</code></pre><p>Thereafter, we add the following large code chunks.</p>
<pre><code>var geoJsonUrl = &quot;https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/selected_hospitals.json&quot;

    var geojsonLayer = $.ajax({
    url : geoJsonUrl,
    dataType : &apos;json&apos;,
    jsonpCallback: &apos;getJson&apos;,
    success : console.log(&quot;Data successfully loaded!&quot;),
    });

geoJson2heat = ((geojson) =&gt; {
        return geojson.features.map(function(feature) {
        return [parseFloat(feature.geometry.coordinates[1]), 
                parseFloat(feature.geometry.coordinates[0])];
        });
        });


$.when(geojsonLayer).done(function() {
        // var kill = L.geoJSON(geojsonLayer.responseJSON);
        var layer = geoJson2heat(geojsonLayer.responseJSON, 4);
        var heatMap = L.heatLayer(layer, { 
                radius: 40,
                blur: 10, 
                gradient: {
                        &apos;0&apos;: &apos;Navy&apos;, &apos;0.25&apos;: &apos;Navy&apos;,
                        &apos;0.26&apos;: &apos;Green&apos;,
                        &apos;0.5&apos;: &apos;Green&apos;,
                        &apos;0.51&apos;: &apos;Yellow&apos;,
                        &apos;0.75&apos;: &apos;Yellow&apos;,
                        &apos;0.76&apos;: &apos;Red&apos;,
                        &apos;1&apos;: &apos;Red&apos;
                      },
                maxZoom: 13});
        map.addLayer(heatMap);
        });
</code></pre><p>To give credit where it is due, the code chunks were taken from <a href="https://gis.stackexchange.com/questions/337294/heatmap-with-geojson-leaflet-and-leaflet-heat-plugin?utm_source=pocket_reader" target="_blank">this Stack Overflow question</a> and modified a bit. Let&apos;s do everyone some justice by going through the preceding code bit by bit.</p>
<pre><code>var geoJsonUrl = &quot;https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/selected_hospitals.json&quot;

    var geojsonLayer = $.ajax({
    url : geoJsonUrl,
    dataType : &apos;json&apos;,
    jsonpCallback: &apos;getJson&apos;,
    success : console.log(&quot;Data successfully loaded!&quot;),
    });
</code></pre><p>The <code>var geoJsonUrl</code> holds the link to our hospitals json file. The <code>var geojsonLayer</code> uses the Asynchronous Javascript And Xml (Ajax) method to load data from our Github server. If successful, we get the message &quot;Data successfully loaded!&quot; in our browser console. </p>
<pre><code>geoJson2heat = ((geojson) =&gt; {
        return geojson.features.map(function(feature) {
        return [parseFloat(feature.geometry.coordinates[1]), 
                parseFloat(feature.geometry.coordinates[0])];
        });
        });
</code></pre><p>The above code chunk is fairly easy to understand. The function passed to <code>geoJson2heat</code> uses the <code>map</code> method to iterate over every element, such as cities in the json file and retrieve the longitude and latitude coordinates. Notice the format has been inverted. Rather than [0]... [1] for Lat-Lon, we use [1]...[0]. </p>
<p>The final is a jQuery function that will return the desired heatmap layer.</p>
<pre><code>$.when(geojsonLayer).done(function() {
        // var kill = L.geoJSON(geojsonLayer.responseJSON);
        var layer = geoJson2heat(geojsonLayer.responseJSON, 4);
        var heatMap = L.heatLayer(layer, { 
                radius: 40,
                blur: 10, 
                gradient: {
                        &apos;0&apos;: &apos;Navy&apos;, &apos;0.25&apos;: &apos;Navy&apos;,
                        &apos;0.26&apos;: &apos;Green&apos;,
                        &apos;0.5&apos;: &apos;Green&apos;,
                        &apos;0.51&apos;: &apos;Yellow&apos;,
                        &apos;0.75&apos;: &apos;Yellow&apos;,
                        &apos;0.76&apos;: &apos;Red&apos;,
                        &apos;1&apos;: &apos;Red&apos;
                      },
                maxZoom: 13});
        map.addLayer(heatMap);
        });
</code></pre><p>Honestly the last was a bit of a stretch since jQuery is hardly used in Leaflet or in normal JavaScript programming nowadays.</p>
<p><img src="images/heatmap.jpg" alt=""></p>
<p>The full code files are available from <a href="https://github.com/sammigachuhi/my-leaflet-project/tree/main/my-leaflet-code/chapter-9-Heatmaps" target="_blank">here</a>.</p>
<p><strong>NB:</strong> It should be noted that all manner of efforts were employed to <a href="https://chat.openai.com/share/b76f0402-b1df-4585-997e-d2421cd68b6b" target="_blank">create a heatmap</a> using <code>L.heatLayer</code>. The most promising seemed nesting the <code>L.heatLayer</code> within the simple <code>L.geoJson.ajax</code> class encountered numerous times so far. All attempts, including <a href="https://chat.openai.com/share/7230d651-2959-407e-8e92-5500d470c8af" target="_blank">asking ChatGPT</a> for a plausible solution, were unsuccessful.</p>
<h2 id="summary">Summary</h2>
<p>Heatmaps are one of the simplest forms of maps in geography. They use color and hue to visualize the concentration of phenomena across space. Here are the take home notes from this chapter.</p>
<ul>
<li><p>Heatmaps are a type of maps that geographically visualize locations with patterns of higher than average occurrence of particular variables.</p>
</li>
<li><p>In order to draw heatmaps using Leaflet, we have to download the <code>Leaflet.heat</code> plugin. Thereafter, the path to the plugin is parsed to the <code>script</code> tag of your HTML file.</p>
</li>
<li><p>Apart from using L.heatLayer, the other alternative of creating heatmaps from GeoJSON data is through a combination of Ajax and jQuery.</p>
</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="08-Creating_controls.html" class="navigation navigation-prev " aria-label="Previous page: Chapter 8">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="10-Clustering_marker_points.html" class="navigation navigation-next " aria-label="Next page: Chapter 10">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Chapter 9","level":"1.10","depth":1,"next":{"title":"Chapter 10","level":"1.11","depth":1,"path":"10-Clustering_marker_points.md","ref":"10-Clustering_marker_points.md","articles":[]},"previous":{"title":"Chapter 8","level":"1.9","depth":1,"path":"08-Creating_controls.md","ref":"08-Creating_controls.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"}},"file":{"path":"09-Heatmaps.md","mtime":"2026-01-30T19:32:32.258Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2026-01-30T19:51:43.548Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

