
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Chapter 11 Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="12-Web_Map_Services.html" />
    
    
    <link rel="prev" href="10-Clustering_marker_points.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="01-Introduction.html">
            
                <a href="01-Introduction.html">
            
                    
                    Chapter 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="02-First_Leaflet_Map.html">
            
                <a href="02-First_Leaflet_Map.html">
            
                    
                    Chapter 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="03-Add_ons.html">
            
                <a href="03-Add_ons.html">
            
                    
                    Chapter 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="04-Embedding_Leaflet_Map_to_an_External_Website.html">
            
                <a href="04-Embedding_Leaflet_Map_to_an_External_Website.html">
            
                    
                    Chapter 4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="05-Using_geojson_files_in_Leaflet.html">
            
                <a href="05-Using_geojson_files_in_Leaflet.html">
            
                    
                    Chapter 5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="06-Custom_markers.html">
            
                <a href="06-Custom_markers.html">
            
                    
                    Chapter 6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="07-Creating_an_interactive_choropleth_map.html">
            
                <a href="07-Creating_an_interactive_choropleth_map.html">
            
                    
                    Chapter 7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="08-Creating_controls.html">
            
                <a href="08-Creating_controls.html">
            
                    
                    Chapter 8
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="09-Heatmaps.html">
            
                <a href="09-Heatmaps.html">
            
                    
                    Chapter 9
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="10-Clustering_marker_points.html">
            
                <a href="10-Clustering_marker_points.html">
            
                    
                    Chapter 10
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.12" data-path="11-Mobile_friendly_web_apps.html">
            
                <a href="11-Mobile_friendly_web_apps.html">
            
                    
                    Chapter 11
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="12-Web_Map_Services.html">
            
                <a href="12-Web_Map_Services.html">
            
                    
                    Chapter 12
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="13-Standard_website_with_leaflet_project.html">
            
                <a href="13-Standard_website_with_leaflet_project.html">
            
                    
                    Chapter 13
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="14-ESRI_Leaflet.html">
            
                <a href="14-ESRI_Leaflet.html">
            
                    
                    Chapter 14
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Chapter 11</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="mobile-friendly-webapps">Mobile Friendly Webapps</h1>
<h2 id="the-need-for-mobile-friendly-web-apps">The need for mobile friendly web apps</h2>
<p>Short story. Not too long ago I was the proud owner of a famous phone brand on the decline. One time, when taking a photo of the iconic Ngong Hills for <a href="https://www.wikilovesafrica.net/wikipedias-photographic-competition-focuses-on-africas-climate-weather/" target="_blank">Wikipedia&apos;s Africa Climate photo contest</a>, the phone just died. That was it. A quick visit to the authorized dealer was greeted with the unbelievable and bemusing words of, &quot;We no longer ship the motherboard to the country anymore.&quot; Some healing has taken place, but I was totally heartbroken, and occassionaly suffer some nostalgia of the &apos;good times&apos; I had with my phone.</p>
<p>Now back to business. Webapps can be heavy, and they can load slowly on smaller devices such as smartphones. Apps that load slow can put off your web app users, so it is prudent to customize your webapp for your user&apos;s phones. </p>
<p>For this chapter, we will work on making our cluster marker app mobile friendly. We shall also add other functionalities to make the web app &apos;heavier&apos; in order to test to destruction if our ambitions of making our app load faster have worked. </p>
<p>In order to create a mobile friendly Leaflet experience, insert the below code within the <code>&lt;head&gt;</code> element of your <code>map.html</code>. The below <code>meta</code> tag tells the browser to disable unwanted scaling of the page and instead set it to its actual size.</p>
<pre><code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;
</code></pre><h2 id="the-basemaps">The basemaps</h2>
<p>If you have gone through [Chapter 8][Layer groups and controls] where we created controls, the following will look familiar. We will add some basemaps and later on create their control widgets.</p>
<pre><code>// Basemaps
var osm = L.tileLayer(&apos;https://tile.openstreetmap.org/{z}/{x}/{y}.png&apos;, {
    maxZoom: 19,
    attribution: &apos;&amp;copy; &lt;a href=&quot;http://www.openstreetmap.org/copyright&quot;&gt;OpenStreetMap&lt;/a&gt;&apos;
});

var cyclOSM = L.tileLayer(&apos;https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png&apos;, {
    maxZoom: 20,
    attribution: &apos;&lt;a href=&quot;https://github.com/cyclosm/cyclosm-cartocss-style/releases&quot; title=&quot;CyclOSM - Open Bicycle render&quot;&gt;CyclOSM&lt;/a&gt; | Map data: &amp;copy; &lt;a href=&quot;https://www.openstreetmap.org/copyright&quot;&gt;OpenStreetMap&lt;/a&gt; contributors&apos;
}); // the CyclOSM tile layer available from Leaflet servers
</code></pre><p>Let&apos;s add our basemaps to Leaflet.</p>
<pre><code>// Add the Leaflet basemaps
var map = L.map(&apos;myMap&apos;, {
    layers: [osm, cyclOSM]
}).setView([-1.295287148, 36.81984753], 7);
</code></pre><h2 id="adding-the-features">Adding the features</h2>
<p>Remember our hospital json layer? Let&apos;s call it again and transform it to a cluster marker with <code>fetch</code>.</p>
<pre><code>// Add hospital dataset

url = &apos;https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/selected_hospitals.json&apos;

var cluster = fetch(url)
    .then((response) =&gt;{
        return response.json()
    })
    .then((data) =&gt; {
        var markers = L.markerClusterGroup();

        var geojsonGroup = L.geoJSON(data, {
            onEachFeature : function(feature, layer){
                var popupContent =  `&lt;b&gt;Facility Name:&lt;/b&gt; ${feature.properties.Facility_N} &lt;br&gt;
                &lt;b&gt;Type:&lt;/b&gt; ${feature.properties.Type}`;
                layer.bindPopup(popupContent)
            },
            pointToLayer: function (feature, latlng) {
                return L.circleMarker(latlng);
            }
        });

        markers.addLayer(geojsonGroup);
        map.addLayer(markers);

    })
    .catch((error) =&gt; {
        console.log(`This is the error: ${error}`)
    })
</code></pre><p>Why was the <code>fetch</code> code being parsed to <code>var cluster</code>?  Well, we were aiming for the stars. We wanted to have a layer control for our <code>cluster</code> variable too but unfortunately this plan failed. </p>
<p>Let&apos;s put our <code>basemaps</code> and <code>cluster</code> variables into JavaScript objects in order to create a layer control for each.</p>
<pre><code>// Set object for the basemaps
var basemaps = {
    &quot;OpenStreetMap&quot;: osm,
    &apos;cycleOsm&apos;: cyclOSM,
}

////Don&apos;t add the &apos;overlays&apos; object. For demonstration purposes only
// Set object for the overlay maps
var overlays = {
    &apos;Hospitals&apos;: cluster
}
</code></pre><p>Before you head on any further, inserting the <code>overlays</code> object into the <code>L.control.layers()</code> class results in several errors. This is why we were unable to create a control for the markers held in <code>var cluster</code>. The image below shows the errors appearing in the console after inserting the <code>overlays</code> object into <code>L.control.layers()</code>.</p>
<p><img src="images/mobile-friendly-error.jpg" alt=""></p>
<p>To get rid of the error showcased above, just comment out the <code>overlays</code> object and remove it from <code>L.control.layers()</code>. The <code>L.control.layers()</code> class should only contain the <code>basemap</code> object.</p>
<h2 id="zooming-to-the-mobile-users-location">Zooming to the mobile user&apos;s location</h2>
<p>According to the Leaflet official documentation, Leaflet has a handy shortcut of zooming in to the user&apos;s location. If for some reason it will not pinpoint the exact coordinates, it will create a buffer around the mobile user&apos;s approximate location. </p>
<pre><code>// Zoom to your location
map.locate({setView: true, maxZoom: 16});
</code></pre><h2 id="add-marker-to-mobile-users-geolocation">Add marker to mobile user&apos;s geolocation</h2>
<p>Even if the location is off by a couple of miles, at least a marker to show the triangulated position will help. At least you will not be <em>all over</em> the map! The following code adds a marker to the mobile user&apos;s triangulated Latitude-Longitude coordinates, and displays a message showing the radius in which the mobile user is most likely to be found from the marker point.</p>
<pre><code>// Add marker at your location
function onLocationFound(e) {
    var radius = e.accuracy;

    L.marker(e.latlng).addTo(map)
        .bindPopup(&quot;You are within &quot; + Number((radius/1000).toFixed(2)) + &quot; kilometers from this point&quot;).openPopup();

    L.circle(e.latlng, radius).addTo(map);
}
</code></pre><p>Incase you forgot, the <code>on</code> method adds listeners. As a gentle reminder, listeners are codes that run when an event is triggered, such as the simple hovering of a mouse over a feature. In the below code, the listener <code>&apos;locationfound&apos;</code> triggers the <code>onLocationFound</code> function in case Leaflet successfully approximated the user&apos;s location.</p>
<pre><code>map.on(&apos;locationfound&apos;, onLocationFound);
</code></pre><p>The <code>locationfound</code> listener is responsible for the message bounded in red below when a browser loads a Leaflet map. Clicking <strong>Allow</strong> will give the browser the heads up to zoom to the user&apos;s location as it best can.</p>
<p><img src="images/location-found.jpg" alt=""></p>
<p>What if, getting the mobile user&apos;s geolocation is unsuccessful? We will create a function that outputs the error event to our console, as shown below.</p>
<pre><code>// Error displayed after finding location failed
function onLocationError(e) {
    alert(e.message);
}
</code></pre><p>Actually, <code>message</code> is an error event that displays the error message of a parameter. The <code>message</code> event is parsed to the <code>onLocationError</code> function. If the browser fails to approximate the user&apos;s location, the <code>onLocationError</code> function returns &apos;true&apos; which triggers an error alert on the browser.</p>
<pre><code>map.on(&apos;locationerror&apos;, onLocationError);
</code></pre><h2 id="the-mobile-webmap-app">The mobile webmap app</h2>
<p>Yours truly has saved you the hustle of detailing how this chapter&apos;s files have been saved to Github and subsequently converted to a webpage. The key thing to note is that the HTML file has to be named as <code>index.html</code> and not any other name such as <code>map.html</code> since the name &apos;index&apos; is the easiest way to render a file on the fly on Github. Some additional steps exist to launch our Leaflet map to the global web but to ensure brevity in this chapter, we suggest you visit this authoritative <a href="https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-github-pages-site" target="_blank">Github page</a> for further guidance. The link below should nevertheless allow you to view the webapp on your phone.</p>
<p><a href="https://sammigachuhi.github.io/hospitals_webapp/" target="_blank">https://sammigachuhi.github.io/hospitals_webapp/</a></p>
<p><img src="images/mobile-app.jpg" alt=""></p>
<p>We had initially aimed for the stars by wanting to create a web app that in addition to the basemap layers, it would also feature some layer controls. However, it seemed like we landed on the skies instead. Nevertheless, this looks like a good hospital locations app. The sky is only the baseline for what further features can be built on top of this app.</p>
<p>The full code script is available from <a href="https://github.com/sammigachuhi/my-leaflet-project/tree/main/my-leaflet-code/chapter-11-mobile-friendly-webapps" target="_blank">here</a>.</p>
<h2 id="summary">Summary</h2>
<p>Enabling a Leaflet map to be mobile friendly allows the Leaflet map to load fast as well as scale efficiently on a smartphone. Here is what you&apos;ve learnt.</p>
<ul>
<li><p>A special <code>meta</code> tag is inserted in the <code>&lt;head&gt;</code> element of your HTML file to enable the browser scale smoothly when a user is viewing a Leaflet map on a smartphone.</p>
</li>
<li><p>Leaflet has a special function, the <code>map.locate</code> that geolocates and zooms to the user&apos;s exact coordinates. If for some reason precision fails, it creates a buffer around the mobile user&apos;s approximate location.</p>
</li>
<li><p>In case Leaflet is unable to approximate the user&apos;s location, one can resort to the <code>message</code> event which throws back an error on the browser.</p>
</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="10-Clustering_marker_points.html" class="navigation navigation-prev " aria-label="Previous page: Chapter 10">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="12-Web_Map_Services.html" class="navigation navigation-next " aria-label="Next page: Chapter 12">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Chapter 11","level":"1.12","depth":1,"next":{"title":"Chapter 12","level":"1.13","depth":1,"path":"12-Web_Map_Services.md","ref":"12-Web_Map_Services.md","articles":[]},"previous":{"title":"Chapter 10","level":"1.11","depth":1,"path":"10-Clustering_marker_points.md","ref":"10-Clustering_marker_points.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"}},"file":{"path":"11-Mobile_friendly_web_apps.md","mtime":"2026-01-30T19:33:51.778Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2026-02-01T10:07:22.915Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

